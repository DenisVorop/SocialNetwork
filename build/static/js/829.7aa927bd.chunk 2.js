"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[829],{8020:function(e,s,a){a(2791);s.Z=a.p+"static/media/arrrow.ceb7a8aba934b6b115350c17c345ff36.svg"},1829:function(e,s,a){a.r(s),a.d(s,{default:function(){return b}});var n=a(2982),t=a(885),r=a(184),i=function(e){return(0,r.jsxs)("div",{className:"messages-body__messagefield",children:[(0,r.jsxs)("div",{className:"messages-body__block",children:[(0,r.jsx)("div",{className:"messages-body__userphoto",children:(0,r.jsx)("img",{src:e.image,alt:"person avatar"})}),(0,r.jsx)("div",{className:"messages-body__username",children:e.userName})]}),(0,r.jsx)("div",{className:"messages-body__message",children:e.textMessage})]})},o=(a(4177),a(2791)),d=a(5705),c=a(132),l=a(8867),u=a(8020),m=function(e){var s=c.Ry().shape({newMessageText:c.Z_().typeError("string expected!").required("Obligatory field!")});return(0,r.jsx)(d.J9,{initialValues:{newMessageText:""},validateOnBlur:!0,onSubmit:function(s,a){var n=a.resetForm;e.addNewMessage(s),n({newMessageText:""})},validationSchema:s,children:function(s){var a=s.values,n=s.errors,t=s.touched,i=s.handleBlur,o=s.handleSubmit,c=s.handleChange;return(0,r.jsxs)("div",{className:"messages-body__form",children:[(0,r.jsxs)("div",{className:"profile-body__form",children:[(0,r.jsx)(d.l0,{children:(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{placeholder:"Write smth here and tap to btn",className:l.Z._area,type:"text",name:"newMessageText",onChange:c,onBlur:i,value:a.newMessageText})})}),(0,r.jsx)("div",{className:"profile-body__addpost",children:(0,r.jsx)("button",{disabled:e.webSocket.readyState!==WebSocket.OPEN,onClick:o,type:"submit",className:l.Z.search,children:(0,r.jsx)("img",{src:u.Z,alt:""})})})]}),t.newMessageText&&n.newMessageText&&(0,r.jsx)("p",{className:"error",children:n.newMessageText})]})}})},g=a(1548),h=a(3504),x=a(9188),f=function(e){var s="/messages/"+e.id;return(0,r.jsx)("div",{className:"messages-body__user",children:(0,r.jsxs)(h.OL,{to:s,className:"messages-body__dialog",children:[(0,r.jsx)("div",{className:"messages-body__image",children:(0,r.jsx)("img",{src:x,alt:"hedgehog"})}),e.name]})})},v={dialogData:[{id:1,name:"Darya"},{id:2,name:"Maksim"},{id:3,name:"Fuad"},{id:4,name:"Faig"},{id:5,name:"Anatolich"},{id:6,name:"Denis"}]},b=(0,g.D)((function(){var e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),s=(0,o.useRef)(null),a=(0,o.useState)(!0),d=(0,t.Z)(a,2),c=d[0],l=d[1];(0,o.useEffect)((function(){e.addEventListener("message",(function(e){var s=JSON.parse(e.data);x((function(e){return[].concat((0,n.Z)(e),(0,n.Z)(s))}))}))}),[]);var u=(0,o.useState)([]),g=(0,t.Z)(u,2),h=g[0],x=g[1];(0,o.useEffect)((function(){var e;c&&(null===(e=s.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[h]);var b=v.dialogData.map((function(e,s){return(0,r.jsx)(f,{name:e.name,id:e.name},s)})),p=h.map((function(e,s){return(0,r.jsx)(i,{textMessage:e.message,image:e.photo,userName:e.userName},s)}));return(0,r.jsx)("div",{className:"body__messages messages-body",children:(0,r.jsxs)("div",{className:"messages-body__row",children:[(0,r.jsx)("div",{className:"messages-body__dialogs",children:b}),(0,r.jsxs)("div",{className:"messages-body__right",children:[(0,r.jsxs)("div",{className:"messages-body__messages",style:{overflowY:"auto"},onScroll:function(e){var s=e.currentTarget;Math.abs(s.scrollHeight-s.scrollTop-s.clientHeight)<300?!c&&l(!0):c&&l(!1)},children:[p,(0,r.jsx)("div",{ref:s})]}),(0,r.jsx)(m,{addNewMessage:function(s){s.newMessageText&&e.send(s.newMessageText)},webSocket:e})]})]})})}))},1548:function(e,s,a){a.d(s,{D:function(){return g}});var n=a(8683),t=a(5671),r=a(3144),i=a(136),o=a(3668),d=a(2791),c=a(7581),l=a(6871),u=a(184),m=function(e){return{isAuth:e.authReducer.isAuth}},g=function(e){var s=function(s){(0,i.Z)(d,s);var a=(0,o.Z)(d);function d(){return(0,t.Z)(this,d),a.apply(this,arguments)}return(0,r.Z)(d,[{key:"render",value:function(){return this.props.isAuth?(0,u.jsx)(e,(0,n.Z)({},this.props)):(0,u.jsx)(l.Fg,{to:"/login"})}}]),d}(d.Component);return(0,c.$j)(m)(s)}},4177:function(){},9188:function(e,s,a){e.exports=a.p+"static/media/hedgehog.921a6b59f27ae6f7a733.png"}}]);
//# sourceMappingURL=829.7aa927bd.chunk.js.map